<!DOCTYPE html>
<html>
    <head>
	     <script src="https://code.jquery.com/jquery-3.6.0.js" integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk=" crossorigin="anonymous"></script>
    </head>

    <body>

	<script>
		function check_form()
		{
			//update this later to check the inputs values
			//user name taken ect...
			alert($('#username').val());
			alert($('#password').val());
			return true;
		}
	</script>


	<script>
		function addNewUserClicked()
		{
			//alert("New User Created");
			$.ajax({
				type: "POST",
				url: "/createNewUser",
				data: $("#addNewUserForm").serialize(),
				success: function(data)
				{
					if(data == "VALID")
					{
						$('#addNewUser').hide();
					        $('#login').show();
						//alert(data);
					}
					else
					{
						alert("bad user creation please try again");
					}
				}
			});
			return true;
		}
	</script>


	<script>
		function addUserClicked()
		{
			console.log("clicked button to add a new user");
			$('#login').hide();
			$('#addNewUser').show();
			return true;
		}
	</script>

	<script>
	        function goToLogIn()
                {
			console.log("clicked button to logout");
			$('#books').hide();
			$('#login').show();
			return true;
		}
        </script>


	<script>
		function loginClicked()
		{
			$.ajax({
				type: "POST",
				url: "/userAuth",
				data: $("#loginForm").serialize(),
				success: function(data)
				{
					if(data == "VALID")
					{
						$('#login').hide();
						$('#books').show();
						showBooks();
					}
					else
					{
						alert("bad long in please try again");
					}
				}
			});
		}
	</script>



	<script>
		function showBooks()
		{
			$.ajax({
				type: "GET",
				url: "/getBooks",
				success:function(data)
				{
					for(var i = 0; i < data.name.length; i++)
					{
						$('#bookList').append($('<option>', {value: data.name[i], text: 'Title: ' + data.name[i] + ' Price: $' + data.price[i]}));
					}
					//alert("All books listed");
				}
			});
		}
	</script>


	<script>
		function purchaseBookClicked()
		{
			var b = document.getElementById('bookList');
			var strBook = b.options[b.selectedIndex].value;

			$.ajax({
				type:"POST",
				url: "/purchaseBook",
				data: {book: strBook},
				success: function(data)
				{
					alert(data);
					//alert("Thank you for buying one of my books :)");
				}
			});
		}
	</script>


	
	<div id="login">
		<form id="loginForm">
			<label for="username">Username:</label><br>
			<input type="text" id="username" name="username" value="JP"><br>
			<label for="password">Password:</label><br>
			<input type="password" id="password" name="password" value="Password"><br><br>
			<input type="button" value="Login" id="Login" onclick="return loginClicked();">
			<input type="button" value="Create New User" onclick="return addUserClicked();">
		</form>
	</div>

	<div id="addNewUser" style="display:none">
		<form id= "addNewUserForm">
			<label for="username">Username:</label><br>
			<input type="text" id="username" name="username" value="JP"><br>
			<label for="password">New Password:</label><br>
			<input type="password" id="password" name="password" value="Password"><br><br>
			<input type="button" value="Submit" onclick="return addNewUserClicked();">
		</form>
	</div>

	<div id="books" style="display:none">
		<form id="bookDisplay">
			<h1>Buy me</h1>
			<select name="bookList" id="bookList"></select><br>
			<input type="button" value="Purchase Book" id="purchaseButton" onclick="return purchaseBookClicked();">	
			<input type="button" value="Log Out" onclick="return goToLogIn();">
		</form>
	</div>


   </body>
</html>
